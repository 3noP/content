id: playbook McAfee ESM v2 - Test
version: -1
contentitemfields:
  propagationLabels: []
name: playbook McAfee ESM v2 - Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 9728c55d-02fb-43fa-8a9c-8e806ecb2b24
    type: start
    task:
      id: 9728c55d-02fb-43fa-8a9c-8e806ecb2b24
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "5"
      - "7"
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 250,
          "y": 40
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: b380feff-2130-44f6-8ee8-6b585a3611ad
    type: regular
    task:
      id: b380feff-2130-44f6-8ee8-6b585a3611ad
      version: -1
      name: get_user_list
      description: Get a list of all users.
      script: '|||esm-get-user-list'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: b1749fa7-cb21-43a4-8e64-e3cc3e17e2b1
    type: regular
    task:
      id: b1749fa7-cb21-43a4-8e64-e3cc3e17e2b1
      version: -1
      name: get_organization_list
      description: Get case organization
      script: '|||esm-get-organization-list'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 708c6ee3-f0b4-47a6-88cc-e0e745e45db4
    type: regular
    task:
      id: 708c6ee3-f0b4-47a6-88cc-e0e745e45db4
      version: -1
      name: get_case_list
      description: Get a list of cases from the system
      script: '|||esm-get-case-list'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      since:
        simple: 3 months
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: b16d5bf4-1b89-4048-85c5-f23b5895e0e6
    type: regular
    task:
      id: b16d5bf4-1b89-4048-85c5-f23b5895e0e6
      version: -1
      name: get_case_statuses
      description: Get a list of valid case statuses from the system
      script: '|||esm-get-case-statuses'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: cbd12b21-955c-4618-85d1-494b12a7518a
    type: regular
    task:
      id: cbd12b21-955c-4618-85d1-494b12a7518a
      version: -1
      name: add_case
      description: Add a case to the system
      script: '|||esm-add-case'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      assignee: {}
      organization: {}
      severity: {}
      status: {}
      summary:
        simple: McAfee ESM v2 add case test
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 56546de2-6792-4468-8807-dd04815803f6
    type: regular
    task:
      id: 56546de2-6792-4468-8807-dd04815803f6
      version: -1
      name: edit_case
      description: Edit an existing case
      script: '|||esm-edit-case'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      assignee: {}
      id:
        simple: ${Case.ID}
      organization: {}
      severity: {}
      status: {}
      summary:
        simple: McAfee v2 edit case test
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: 5f56f8ed-75a0-4867-889b-43af7044ca1f
    type: regular
    task:
      id: 5f56f8ed-75a0-4867-889b-43af7044ca1f
      version: -1
      name: add_case_status
      description: Add a case status
      script: '|||esm-add-case-status'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      name:
        simple: AAA
      show_in_case_pane: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: b71d569f-b912-4d76-8297-d17f9ecfbecf
    type: regular
    task:
      id: b71d569f-b912-4d76-8297-d17f9ecfbecf
      version: -1
      name: edit_case_status
      description: Edit a case status
      script: '|||esm-edit-case-status'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      new_name:
        simple: BBB
      original_name:
        simple: AAA
      show_in_case_pane: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: 55f6b308-0bf3-43e1-82ea-1057a81f58b4
    type: regular
    task:
      id: 55f6b308-0bf3-43e1-82ea-1057a81f58b4
      version: -1
      name: delete_case_status
      description: Delete a case status
      script: '|||esm-delete-case-status'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      name:
        simple: BBB
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: abdcfcb6-0ebe-40fd-8282-0e1580b0902f
    type: regular
    task:
      id: abdcfcb6-0ebe-40fd-8282-0e1580b0902f
      version: -1
      name: search
      description: Perform a query against Mcafee ESM SIEM
      script: '|||esm-search'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      customEnd: {}
      customStart: {}
      fields: {}
      filters:
        simple: '[{"type":"EsmFieldFilter","field":{"name":"SrcIP"},"operator":"IN"}]'
      limit:
        simple: "30"
      queryType: {}
      timeOut: {}
      timeRange:
        simple: CURRENT_YEAR
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -350,
          "y": 170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: 318df7b7-fe46-467a-8f12-8437edba88c6
    type: regular
    task:
      id: 318df7b7-fe46-467a-8f12-8437edba88c6
      version: -1
      name: get_alarm_event_details
      description: Gets the details for the triggered alarm
      script: '|||esm-get-alarm-event-details'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      eventId:
        simple: ${McAfeeESM.[0].AlertIPSIDAlertID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -350,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: 2a2e9fc6-c3a4-4580-822f-835230fd06e3
    type: regular
    task:
      id: 2a2e9fc6-c3a4-4580-822f-835230fd06e3
      version: -1
      name: get_case_event_list
      description: Get case events details
      script: '|||esm-get-case-event-list'
      type: regular
      iscommand: true
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      ids:
        simple: ${McAfeeESM.[0].AlertIPSIDAlertID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -350,
          "y": 450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: d0632911-6ed3-4edb-83a8-11b4922efc7a
    type: title
    task:
      id: d0632911-6ed3-4edb-83a8-11b4922efc7a
      version: -1
      name: done
      type: title
      iscommand: false
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 250,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 785,
        "width": 1580,
        "x": -350,
        "y": 40
      }
    }
  }
inputs: []
outputs: []
